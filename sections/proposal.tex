\section{The A3-E Model}\label{sec:proposal}

\begin{figure}[tbp]
	\includegraphics[width=1\textwidth]{figs/A3-E-model.pdf}
	\caption{The A3-E Model.}
	\label{fig:A3-E-model}
\end{figure}

As depicted in Fig.~\ref{fig:A3-E-model}, the A3-E model consists of the different actors and mechanisms required for the realization of the cloud-edge-mobile continuum. Its name inherits from the four phases process -- namely, \textit{(\textbf{A}wareness), (\textbf{A})cquisition, (\textbf{A})llocation, and (\textbf{E})ngagement}. Each phase encompasses activities that take care of specific concerns in the interaction among client applications and the constituents of the continuum. To address the continuum heterogeneity, the A3-E process is flexible with respect to which phases are employed and how they are employed.

The A3-E model also encompasses the concepts of client applications, requests, requirements, services, and domains. The later provides an abstraction of whatever network infrastructure and computational resources (i.e., those used by cloud, mobile-edge, local-edge, and mobile devices). Moreover, the model includes a client-side middleware (CSM) and a domain-side middleware (DSM) implementing the A3-E process. The CSM is responsible for handling client application requests and forwarding them to the domain that best satisfies the client application requirements. In turn, the DSM is responsible for the self-management of services life-cycle in a given domain. Finally, the constituents of the continuum (i.e., cloud datacenters, edge servers, and mobile devices) are respectively represented in the model by the cloud-domain, edge-domain, and mobile-domain. Each domain contains its own and potentially heterogeneous pool of computational resources.

%whose instances are employed by clients and the different types of computational resources composing the continuum. 

Next, we describe the four phases depicted in Fig.~\ref{fig:A3-E-process}, which represents the A3-E process with its four phases. Along their description, the possible instances of the process are mapped to distinct scenarios of the compute continuum, including those in which one or more phases are not employed.

%\subsection{A3-E Process: Phases}\label{sec:A3-E-process}

%Next, the four A3-E phases are further described and mapped to the requirements elicited in  Section~\ref{sec:requirements}. Later on, other possible instances of the A3-E model are correlated with scenarios of the compute continuum.

\subsection{Engagement Phase}\label{sec:A3-E-engagement}

The \textit{engagement} phase models the interaction between a client application and a domain in the continuum. At this stage, the application request has been handled and parsed by the CSM. Also, the CSM must have chosen the best domain alternative among those available. Finally, the selected domain must be ready to process the requests.

In order to overcome the heterogeneity of the continuum, A3-E adheres to the use of service-orientation paradigm to allow clients to engage with remote \textit{services} (i.e., cloud and edge-based services) by means of a request/response protocol (e.g., RESTful services over HTTP). As an exception, computation provided by mobile devices can be accessed by means of local calls. Notwithstanding this, to enforce a common interface between clients and the heterogeneous domains, mobile devices should also expose computation that may be offloaded as local services. 

\begin{figure}[tbp]
	\includegraphics[width=0.95\textwidth]{figs/A3-E-process}
	\caption{The A3-E Process. Phases are delimited by vertical lines and the main activity of each phase by the label within each phase; labels within parenthesis represent the states of a domain to a client (and vice-versa)}
	\label{fig:A3-E-process}
\end{figure}

\subsection{Allocation Phase}\label{sec:A3-E-allocation}

\begin{figure}[thbp]
	\centering
	\captionsetup[subfigure]{width=0.4\textwidth}	
	\null\hfill
	\subfloat[Services allocation control loop; domains must monitor the QoS of deployed services and adapt its allocation scheme to prevent SLA violation.\label{fig:service-allocation-loop}]{ \includegraphics[width=0.4\textwidth]{figs/service-allocation-loop}}
	\captionsetup[subfigure]{width=0.4\textwidth}	
	\hfill
	\subfloat[Domain selection control loop; clients must monitor available domains and select the one that best satisfies its requirements.\label{fig:domain-selection-loop}] {\includegraphics[width=0.4\textwidth]{figs/domain-selection-loop}}
	\hfill\null
	\caption{Self-management control loops for service allocation and domain selection}\label{fig:allocation-loops}
\end{figure}

\subsubsection*{Domain-side} From the domain side, the allocation phase models the placement of computation among the domain's pool of runtime resources (e.g., a pool of containers, CPU(s), memory) needed for the execution of a service. 

Cloud domains traditionally employ automated scaling mechanisms in which virtual machines and container instances are (de)allocated on demand. More recently, cloud-based FaaS platforms (e.g., Amazon Lambda, Google Cloud Functions) extend these mechanisms to stateless functions. The later represent an extreme type of allocation in which no pre-allocation of resources is needed and functions are executed by a shared runtime platform. Aligned to our previous work~\cite{GarrigaMendonca2017}, A3-E addresses the efficiency required by edge domains by adhering to the FaaS execution model.
%in which stateless functions can be deployed and scaled on demand without minimum pre-allocation of resources. 
In turn, mobile domains are exempt of implementing the allocation phase, as in this work we assume that local services to be allocated along with the client application.

On domains, the allocation phase is managed by the DSM and realized with a self-management loop~\cite{kephart2003vision} (Fig.~\ref{fig:service-allocation-loop}) in which the domain's computational resources are allocated and deallocated according to: a) the monitored QoS os services provided by the domain (e.g., the availability of the service); b) the SLA between the service (and consequently the domain) provider and client applications; and c) the availability of computational resources. In specific, domains with limited resources must take into account the priority given to applications with SLA demanding higher levels of availability. 

For instance, edge providers could support two types of SLA: one for critical applications requiring high service availability; and another for non-critical applications that may cope with lower degrees of availability. The first type could be achieved with the pre-allocation of resources to these services, whilst the later could rely on the opportunistic allocation of services upon demand and availability of resources. As an example, connected vehicles could feature a hight availability SLA, while an AR application for guiding tourists could have an opportunistic SLA. During rush hours, edge services may become unavailable for the AR application, during which they would rely on local services (incurring in battery drain) or cloud-based services (incurring in network latency). In all other moments, the AR would be able to rely on edge-based services. 

%The specific algorithms for the placement of services among the domain's resources that should be employed at the analysis phase are out of the scope of this paper. Nonetheless, recent works~\cite{} have addressed this challenge in the context of a continuum formed by edge and cloud datacenters. 

%2) the allocation policy employed by the domain; and 3) the availability of resources. 

\subsubsection{Client-side} From the client side, the allocation phase models the selection of the best domain alternative satisfying the client application requirements for a given service.
%, i.e., it models the computation placement along the client's perception of the continuum. 
This decision should take into account a list of available domains providing services requested by the client application with accompanying QoS attributes. Accordingly, whereas the domains should take care of intra-domain allocation through service placement, the clients are responsible for the inter-domain allocation through service selection.

Analogously to the domain-side control loop, the allocation phase is managed by the CSM  and realized with a self-management control loop (Fig.~\ref{fig:domain-selection-loop}) in which the client checks for the QoS levels of each available domain and decides for the alternative that best satisfies its requirements. Importantly, 
%This sub-process is the main client-side activity required for the realization of the continuum, as it allows clients to seamlessly alternate among different continuum domains according to the context. 

For example, upon unavailability of edge domains providing services with low latency, the AR application previously introduced would have to choose among local or cloud domain. If the application requirements prioritizes low battery consumption (e.g., because battery level is low), it should opt for the cloud domain. Otherwise, if low latency is the priority requirement, it should opt for the cloud domain. As the number of requirements grow, a multi-objective optimization algorithm~\cite{Olson1996} may be employed to decide among alternative domains.



%The allocation phase has the following purposes: 1) to enable the efficient (Req. \textbf{R1.1}) and automated (Req. \textbf{R3.1}) allocation of domains' computational resources; and to enable clients to choose the best candidate among different available domains (Req. \textbf{R2.1}).



\subsection{Acquisition Phase}\label{sec:A3-E-acquisition}

%The Acquisition phase has the following purposes: 1) to enable the efficient (Req. \textbf{R1.2}) and automated (Req. \textbf{R3.2}) download and installation of service artifacts; and 2) to enable clients to identify, among the known domains, those compatible with their requirements (Req. \textbf{R2.1}).

\subsubsection*{Domain-side} From the domain side, the allocation phase models the dynamic and automated acquisition of service artifacts upon identification of requirements from a given application. Its ultimate goal is to mitigate the usage of domain resources before actual demand and, more importantly, encapsulate this operational aspect from domain administrators. The later are fundamental for the realization of finely distributed edge domains, specially those integrated to local network infrastructures (e.g., local-edge domains integrated to domestic and office infrastructures).

In addition to edge domains, cloud domains may also benefit from the automated acquisition of services artifacts to address scenarios in which client applications may opportunistically rely on cloud-based services. To the best of our knowledge, the automated acquisition in today's IaaS providers is limited to the replication of virtual machines and containers in which services are already deployed as full applications. Cloud-based FaaS platforms supports the upload of functions from automated process triggered and executed outside the domain. In contrast, the acquisition phase would allow cloud domains to also encapsulate acquisition of service artifacts (e.g., the download of functions exposed as services). In turn, mobile domains are exempt of performing the allocation phase as local services artifacts are assumed to be part of the client application.

The acquisition phase is realized by the DSM with the following process: the domain receives from the CSM the set of application requirements --- namely, the services it needs to be installed and a repository URL from which their corresponding artifacts can be downloaded. Throughout the services life-cycle in the domain, the DSM also checks for new versions of acquired services from the same repositories and updates them accordingly. 

%In case the service has already been acquired or as the acquisition finishes, clients should add that domain to their list of available domains. 
\subsubsection*{Client-side} From the clients perspective, acquisition is modeled by the simple addition of a domain to a list of available domains, which should follow the identification of the domain's capability in providing the requested service(s). This phase is realized by the CSM with the following sub-process: the CSM should expect a confirmation from the DSM regarding its compliance in providing the services required by the application, which includes their acquisition. Once confirmed, the CSM adds that domain to a list of available domains. 

As an example, a real-time translation application featuring translations from/to streams of different spoken languages require services with low-latency, i.e., the translation can either rely on its local mobile domain or on nearby edge domains. Instead of having all artifacts pre-installed, the edge domain acquire the data and codebase from the application repository upon detection of the user in its coverage area. The setup process takes no more than a minute, during which the local mobile domain has been used. Once the setup is ready, the application can start streaming captured conversation to edge services, which in turn reply with a translated audio stream.

%From the domain side, the lack of acquisition implies that service assets must be previously made available. Nonetheless, the preliminary acquisition of a large number of assets is limited by the domain storage capability. 

%Conversely, the automated and opportunistic acquisition of service assets improves storage efficiency with the cost of a setup time $\Delta_{AQ}$. For instance, domains that become aware of clients' requirements may pro-actively start the acquisition phase and become ready for allocation before the first service request arrives.

%otherwise, domains must rely on the detection of a first service request or some other triggering condition to start the acquisition phase and, after setup time $\Delta_A$, become ready for allocation. 


\subsection{Awareness Phase}\label{sec:A3-E-awareness}



%Why do we need awareness?
%CA: awareness is not needed because the edge domain should always be coupled to the network infrastructure; network components shoudl aways route traffic to existing edge servers; additionally, the edge domain should be able to acquire and allocate services upon detection of the first requests.  
%A: A3-E model is agnostic w.r.t. the use of network technologies to route traffic to the edge servers; a given domain my count on network components to traffic route to its servers instead of negociating directly with clients aware of its existance; nonetheless, the lack of awareness limits the acquisition and deployment of services to reactive, as the domain would only identify a given service upon the first request has been made. Clients, in the other hand, would not be able to choose from alternative domains. 

\subsubsection*{Domain-side} Last but not least, from the domain side, the awareness phase models the discovery by a domain of client applications in the domain's coverage area. Its main purpose is to enable domains to pro-actively initialize the acquisition and allocation phases based on the awareness of physical presence of clients in the domain's coverage are. In specific, it copes with the need for efficiency and scalability of finely distributed edge domains by allowing acquisition and/or allocation phases to start as soon as a potential client is present in their coverage area. The benefit lies in the anticipation of (opportunistic) services setup with respect to the arrival of the first service request, i.e., in the mitigation of service setup delay (also known as cold start). Since cloud domains cover a large area, the later do not employ the awareness phase. Needless to say, mobile domains do not require awareness for sharing the same platform with client applications. In contrast, mobile-edge and local-edge domains are the main candidates for employing the awareness phase. 

The awareness phase is realized by the DSM with the following sub-process: the CSM should notify the corresponding DSM about all client application requirements (i.e., services) as soon as it becomes aware of a new domain, i.e., when the mobile host enters the domain's coverage area. For example, in the real-time translation application previously introduced, the service setup delay was mitigated by having the acquisition of the corresponding service data and codebase to start as soon as the user entered the edge domain's coverage area.

\subsubsection*{Client-side} From the clients perspective, the awareness phase models the discovery of domains whose network address is not previously known. In specific, it targets edge domains that are integrated with the local network infrastructure of buildings and public spaces. This modality contrasts with cloud domains featuring a well-known Internet name that is solved by networking components such as traffic managers and domain-name servers. Additionally, it contrasts with mobile-edge domains~\cite{} that may count on specialized components at the cellular infrastructure to route requests to edge servers. 

The awareness phase is realized by the CSM in conjunction with the DSM by having the latter broadcasting messages in the network that should be intercepted by the CSM. 
Such approach should alleviate the battery consumption of mobile devices, as their role is to intercept (react) to messages broadcasted by the domain rather than query for potential domains in the network. As an example, a local-edge domain located at a user's home is discovered whenever the user arrives home and connects to its private network. Once found, this domain becomes an alternative for the provisioning of services required by the many applications hosted by the user's smartphone, tablet, and other IoT gadgets. %New applications installed shall trigger the installation of services by that domain.


%Finally, the Awareness phase has the following purposes: 1) to enable domains to pro-actively initialize the acquisition and allocation phases based on its awareness of applications whose hosting devices happens to be in the domain coverage area (Req.~\textbf{R2.3}); and 2) to enable clients to discover the address of local domains (Req.~\textbf{R2.2}).

%From the domains perspective, the awareness of clients presence in their coverage area allows a proactive download and installation of services artifacts (acquisition phase) and/or the allocation of services (allocation phase) potentially before a first request to that service arrives, alleviating the delay introduced by services setup.  From the clients perspective, the awareness phase increases the range of alternatives from the continuum that can be used to satisfy their requirements.

%Such behavior allows that are opportunistically acquired and/or allocated to mitigate their setup delay by triggering these phases upon awareness of client(s) in their coverage area.

%From the domain side, the lack of awareness of clients in the domain coverage area prevents triggering the acquisition and subsequently allocation phases based on this event. From the client side, the lack of awareness from surrounding domains prevents them to make the decision of which domains to use. In the later case, clients must rely on external components to reach servers (e.g., traffic managers and DNS servers).

%\input{sections/policies}


%
%\subsection{Reference Architecture}
%
%\begin{figure}[tbp]
%	\includegraphics[width=.95\textwidth]{figs/A3-E-reference-architecture}
%	\caption{A3-E architecture in Mobile Devices and Edge Domains}
%	\label{fig:reference-architecture}
%	\end{figure}
	
