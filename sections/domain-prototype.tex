\subsection{Domain-side Middleware: Local-Edge Domain}\label{sec:local-edge-domain-DSM}

%\subsubsection{Local-Edge Domains}

The DSM prototype\footnote{Documentation and source code available at \url{https://github.com/deib-polimi/A3-E-DSM-local-edge/}} described herein focuses on a local-edge domain, and includes the Awareness and Acquisition phases of A3-E. Both the Allocation and Engagement phases are delegated to the FaaS platform (OpenWhisk), which is responsible for the placement of functions to its pool of containers and handles client application requests (fired by the CSM) by means of RESTful endpoints mapped to microservice functions.

The local-edge prototype implements the Awareness phase by broadcasting UDP advertisements in a constant interval. A CSM entering the network should reply with the identification of microservices its client application requires along with the Git repository from which the corresponding artifacts can be fetched during Acquisition phase. Among the downloaded files, a service descriptor provides instructions regarding the artifacts installation (e.g., compilation of Java classes). The Acquisition phase finishes with the deployment of function(s) to OpenWhisk and the CSM success/failure notification. 

\subsection{Domain-side Middleware: Mobile Domain}\label{sec:mobile-domain-DSM}

Herein we describe a mobile domain DSM prototype for the Android platform\footnote{Documentation and source code available at \url{https://github.com/deib-polimi/A3-E-DSM-mobile/}}. As previously explained, mobile domains are exempt of performing all but the engagement phase. The resulting implementation was packaged as a library. The latter should be imported by the Android application willing to register functions to be executed by its mobile domain (see Section~\ref{sec:CSM} for details on the selection of domains).

The prototype supports two types of functions: Java functions, which are natively supported, and JavaScript functions, which require a JNI wrapper for their execution by the Android application. Decoupling between the client application and its mobile domain was achieved with the use of Android events triggered by the CSM (see Section~\ref{sec:CSM}) and handled by the DSM. Each request contains the unique name of a microservice. The later is used in the loopup of the corresponding function by a functions registry. Once found, the function is called with the parameters composing the request. Finally, a callback is called with the return of the function.